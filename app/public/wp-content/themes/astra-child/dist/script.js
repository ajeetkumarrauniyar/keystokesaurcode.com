(()=>{var E=(t,o)=>()=>(o||t((o={exports:{}}).exports,o),o.exports);var h=E(()=>{document.addEventListener("DOMContentLoaded",function(){let t=document.getElementById("mobile-menu-button"),o=document.getElementById("mobile-menu");t&&o&&t.addEventListener("click",function(){o.classList.toggle("hidden");let n=t.getAttribute("aria-expanded")==="true";t.setAttribute("aria-expanded",!n)})});document.addEventListener("DOMContentLoaded",function(){let t=document.getElementById("newsletter-form"),o=document.getElementById("success-modal"),n=document.getElementById("modal-content"),m=document.getElementById("modal-overlay"),f=document.getElementById("close-modal"),d=document.getElementById("confirm-modal"),l=document.getElementById("subscribe-btn");if(!t){console.error("Newsletter form not found");return}if(!o||!n||!m||!f||!d||!l){console.error("One or more modal elements not found");return}let u;function b(){console.log("Opening modal"),u=document.activeElement,o.classList.remove("hidden"),setTimeout(()=>{n.classList.remove("scale-95","opacity-0"),n.classList.add("scale-100","opacity-100")},10),n.setAttribute("aria-modal","true"),n.setAttribute("role","dialog"),o.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden",d.focus(),y()}function a(){console.log("Closing modal"),n.classList.add("scale-95","opacity-0"),n.classList.remove("scale-100","opacity-100"),setTimeout(()=>{o.classList.add("hidden"),o.setAttribute("aria-hidden","true"),n.removeAttribute("aria-modal"),document.body.style.overflow="",u&&u.focus()},300)}function y(){let i=n.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),r=i[0],c=i[i.length-1];n.addEventListener("keydown",function(s){s.key==="Tab"&&(s.shiftKey?document.activeElement===r&&(s.preventDefault(),c.focus()):document.activeElement===c&&(s.preventDefault(),r.focus()))})}t.addEventListener("submit",function(i){i.preventDefault(),console.log("Form submission started");let r=t.querySelector(".newsletter-error");r&&r.remove(),l.disabled=!0,l.textContent="Subscribing...";let c=new FormData(t);for(let e of c.entries())console.log(e[0]+": "+e[1]);let s=t.getAttribute("action");(!s||s==="")&&(console.error("Form action URL is missing!"),s=window.ajax_object?window.ajax_object.ajax_url:"/wp-admin/admin-post.php",console.log("Using default admin-post.php URL:",s)),console.log("Submitting to URL:",s),fetch(s,{method:"POST",body:c,credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"}}).then(e=>{if(console.log("Response status:",e.status),!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);let p=e.headers.get("content-type");return p&&p.includes("application/json")?e.json():e.text().then(v=>{if(console.log("Got text response instead of JSON"),e.ok)return{success:!0};throw new Error("Invalid response format")})}).then(e=>{console.log("Response data:",e),l.disabled=!1,l.textContent="Subscribe Now",e.success?(console.log("Success! Opening modal..."),b(),t.reset()):(console.log("Error:",e.message),g(e.message||"There was a problem with your subscription. Please try again."))}).catch(e=>{console.error("Fetch error:",e),l.disabled=!1,l.textContent="Subscribe Now",g("There was a problem with your submission. Please try again.")})});function g(i){let r=document.createElement("div");r.className="newsletter-error bg-red-900/50 text-red-300 p-4 rounded-md mb-6",r.textContent=i,t.insertBefore(r,t.firstChild)}f.addEventListener("click",a),d.addEventListener("click",a),m.addEventListener("click",a),document.addEventListener("keydown",function(i){i.key==="Escape"&&!o.classList.contains("hidden")&&a()}),window.testModal={open:b,close:a},console.log("Newsletter form initialization completed")})});h();})();
